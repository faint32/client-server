<!DOCTYPE html>
<HTML>
	<head>
		<title>代付款申请</title>
		<meta http-equiv=Content-Type content="text/html; charset=gb2312">
		<meta HTTP-EQUIV="empiresoft" CONTENT="no-cache">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<!-- Styles -->
		<link rel="stylesheet" href="../css/styles.css">
		<link rel="stylesheet" href="../js/custom.css">
		<!--[if IE 6]>
			<link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css" />
		<![endif]-->
		<style type="text/css">
		<!--
		#showp {
			position:absolute;
			width:800px;
			height:560;
			z-index:232;
			left: 60px;
			top: 60px;
		}
		-->
		</style>
	</head>
	<BODY onload="input_focus()" topmargin="0" leftMargin="2" width="100%">
		<form action="" method="post" name="form1">
			<input type="hidden" name="action" value="{action}">
			<input type="hidden" name="end_action" value="">
			<input type="hidden" name="listid" value="{listid}">
			<input type="hidden" name="ischangelistno" value="">
			<input type="hidden" name="state" value="{state}">
			<div id="page">
		<h4 class="icon forms">{menuname} <small></small></h4>
			<div id="top">
				<ul id="menu">
					<!-- <li class="dropdown">
						<a href="#"><span class="caret"></span></a>
					</li> -->
					<li>
						<a href="#" AccessKey='q' onClick="javascript:location='{gotourl}'">返回</a>
					</li>
				</ul>
			</div>
			<div class="wrapper">
				<div class="panel">
					<span style="color: red">{error}</span>
					<fieldset class="form">
						<legend>代付款申请 
							<small>
								&nbsp;单据输入 
							</small></legend>
				        <table width="100%" class=table_form cellspacing="0" cellpadding="0" border="0">
                          <tbody>
                            <tr>
                              <th>单据编号：</th>
                              <td> {listno} </td>
                              <th>单据日期：</th>
                              <td> {date} </td>
                            </tr>
                            <tr>
                              <th>业务员：</th>
                              <td> {dealwithman} </td>
                              <th>付款日期：</th>
                              <td>{fkdate}</td>
                            </tr>
                            <tr>
                              <th>代付款类型：</th>
                              <td> {paytype} </td>
                              <th></th>
                              <td></td>
                            </tr>
                            <tr>
                              <th>备注：</th>
                              <td colspan='3'> {memo_z} </td>
                            </tr>
                          </tbody>
                        </table>
					</fieldset>
					<fieldset class="form">
						<legend>代付款业务单据<small>&nbsp;单据输入</small></legend>
					</fieldset>
					<table class="table" style="width:100%; word-break:break-all;" align="center" id="checktables">
						<thead>
							<tr>
								<th>序号</th>
								<th>银联订单号</th>
								<th >明盛公户</th>
								<th >终端商户</th>
								<th >交易类型</th>
								<th >交易时间</th>
								<th >收款人<br>账号</th>
								<th >收款人<br>开户银行</th>
								<th >收款<br>人姓名</th>
								<th >收款人<br>手机</th>
								<th >交易金额</th>
								<th >代付金额</th>
								<th >扣除手续费</th>
								<th >预计支出日期</th>
								<th >刷卡器<br>设备号</th>
							</tr>
						</thead>
						<tbody>
							<!-- BEGIN prolist -->
							<tr>
								<td  height="25" align="center">{count}</td>
								<td  align="left">
									<a herf="#" onclick="s_addpro(this);" paytype="{paytypee}">{bkordernumber}</a>
								</td>
								<td  align="left">{sdcrname}</td>
								<td  align="left">{author}</td>
								<td  align="left">{paytype}</td>
								<td  align="left">{paydate}</td>
								<td  align="left">{shoucardno}</td>
								<td  align="left">{shoucardbank}</td>
								<td  align="left">{shoucardman}</td>
								<td  align="left">{shoucardmobile}</td>
								<td  align="right">{paymoney}</td>
								<td  align="right">{money}</td>
								<td  align="right">{payfee}</td>
								<td  align="left">{arrivedate}</td>
								<td  align="left">{paycardkey}</td>
							</tr>
							<!-- END prolist -->
						</tbody>
						<tfoot>
							<tr>
								<td colspan="10" align="left" class=tdcolor>
									&nbsp;&nbsp;共&nbsp;{count}&nbsp;条&nbsp;合计：
								</td>
								 <td align="right" class=tdcolor>{all_paymoney}</td>
								
								<td align="right" class=tdcolor>{all_money}</td>
								<td align="right" class=tdcolor>{all_payfee}</td> 
								<td colspan="4" align="right" class=tdcolor>&nbsp;</td>
							</tr>
						</tfoot>
					</table>
					
				</div>
			</div>
			<br>
		</form>
		<div id="addnewconcentbg"
			style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; z-index: 230; display: none"></div>
		<div id="addnewconcent"
			style="position: absolute; left: 10px; top: 30px; z-index: 231; display: none"></div>
		<div id="sending"
			STYLE="LEFT: 0px; WIDTH: 95%; POSITION: absolute; TOP: 50%; HEIGHT: 95%; display: none">
			<table width=400 height=80 border=0 cellspacing=2 cellpadding=0>
				<tr>
					<td bgcolor=#F1F4F9 align=center>正在保存单据，请稍候...</td>
				</tr>
			</table>
		</div>
		<div id="sendingdel"
			STYLE="LEFT: 0px; WIDTH: 95%; POSITION: absolute; TOP: 50%; HEIGHT: 95%; display: none">
			<table width=400 height=80 border=0 cellspacing=2 cellpadding=0>
				<tr>
					<td bgcolor=#F1F4F9 align=center>正在删除单据，请稍候...</td>
				</tr>
			</table>
		</div>
		<div id="sendingbg"
			STYLE="LEFT: 0px; WIDTH: 100%; POSITION: absolute; TOP: 0px; HEIGHT: 100%; display: none"></div>
		<div id="helpid"
			STYLE="right: 1%; WIDTH: 450px; POSITION: absolute; TOP: 86px; HEIGHT: 0; display: none">
			<div align="left"
				STYLE="position: absolute; left: 15px; top: 15px; right: 15px">
				付款单用于先售货后付款的处理，可以直接录入，也可以采用按单结算业务。 
				<br>
				<br>
				操作如下： 
				<br>
				在付款单中，选择付款单位后，系统会自动跳出对此单位未结算完成的销售单以及销售退货单。用户可以对销售单进行对勾，以达到分单结算的目。 
				<br>
				自动分配：在录入本次付款的账户与金额后，自动分配可以将此笔付款自动对应未结清的、账龄最长的几笔单据。 
				<br>
				付款单也可用于其它非销售业务的付款处理，付款单过账后现金或银行存款将增加，应付账款减少。 
				<br>
				<br>
				选择客户或者供应商时，系统就会自动带出该客户或者供应商的所有未付款单据；在付款金额中填上付款的金额，然后按下自动分配，系统就会把付款金额的数额分配到各条单据之中。 如果不喜欢自动分配，也可以手动分配。在各单据中输入的金额之和要与付款金额相等。 
				<br>
				<br>
				确认后，请按暂存保存。 
				<br>
				<br>
				保存(Alt+s)：将付款单转为历史付款单，并进行相应的应付款操作。历史付款单不能删除及修改，只能红字反冲；月结存后不能红字反冲。帐户流水帐中能反映相应该单相应帐户金额的变动。往来对帐单中能反映相应该单据中的往来单位的往来变动。 
				<br>
				<br>
				删除(Alt+d)：即删除不再使用的付款单信息； 
				<br>
				<br>
				返回(Alt+q)：返回付款登记列表； 
				<br>
				<br>
				帮助(Alt+h)：显示帮助信息； 
				<br>
				<br>
				暂存(Alt+t)：添加新草稿付款单，草稿付款单可以修改及删除； 
				<br>
				<br>
			</div>
		</div>
		</center>
</div>
</div>
{showeditdiv}
<div id="showp" style="display:none">
	<center>
		<input type="button" name="save" class="button" value="关闭" AccessKey="t" onClick="javascript:closep()" style="font-size:9pt" />
	</center>
	<iframe id="frmp" width="100%" height="100%" name="frmp"  src="#" scrolling="auto"></iframe>
 </div>
<script language="javascript" type="text/javascript">
<!--
	function InitAjax()
	{
		var ajax = false;
		try {
			ajax = new ActiveXObject("Msxml2.XMLHTTP");
		} catch (e) {
			try {
				ajax = new ActiveXObject("Microsoft.XMLHTTP");
			} catch (e) {
				ajax = false;
			}
		}
		if (!ajax && typeof XMLHttpRequest!='undefined') {
			ajax = new XMLHttpRequest();
		}
		return ajax;
	}

	function s_addpro(element)
	{
		var bkordernumber = element.innerHTML;
		var isagentpay = element.paytype;
		var file = '';
		var postStr = "bkordernumber="+bkordernumber + "&isagentpay="+isagentpay;
		var url = "paymoneylistajax_view.php";//需要进行Ajax的URL地址
		var ajax = InitAjax();//实例化Ajax对象

		ajax.open("POST", url, true);//使用POST方式进行请求
		ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded"); //定义传输的文件HTTP头信息
		ajax.send(postStr);//发送POST数据
		ajax.onreadystatechange = function()//获取执行状态
		{
			if (ajax.readyState == 4 && ajax.status == 200)//如果执行是状态正常，那么就把返回的内容赋值给上面指定的层
			{
				switch (isagentpay) {
					case 'coupon':
						file = '../paycard/couponsale_view.php?listid='+ajax.responseText;
						break;
					case 'creditcard':
						file = '../paycard/creditcard_sp.php?type=check&listid='+ajax.responseText;
						break;
					case 'recharge':
						file = '../paycard/rechargeglist_sp.php?type=check&listid='+ajax.responseText;
						break;
					case 'repay':
						file = '../paycard/repaymoney_sp.php?type=check&listid='+ajax.responseText;
						break;
					case 'tfmg':
						file = '../paycard/transfermoney_sp.php?type=check&listid='+ajax.responseText;
						break;
				    case 'suptfmg':
						file = '../paycard/transfermoney_sp.php?type=check&listid='+ajax.responseText;
						break;
					default:
						break;
				}
				document.getElementById("showp").style.display ="";
				document.frmp.location.href = file;
			}
		}
	}

	function closep()
	{
		document.getElementById("showp").style.display ="none";
	}
// -->
</script>
</BODY>
</HTML>
